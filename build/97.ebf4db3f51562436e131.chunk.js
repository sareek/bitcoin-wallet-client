(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{"6ba8e1e9ce46484b008f":function(t,e,n){"use strict";n.r(e);var o,i=n("8af190b70a6bc55c6f1b"),r=n.n(i),a=(n("8a2d1b95e05b6a321e74"),n("a28fc3c963a1d4d1a2e5")),c=n("d7dd51e1bf6bfc2c9c3d"),s=n("b57570cc703435a24b60"),u="App/common/AdminNotifications/NOTIFICATIONS_FETCH_UNREAD_REQUEST",f="App/common/AdminNotifications/NOTIFICATIONS_FETCH_REQUEST",l="App/common/AdminNotifications/NOTIFICATIONS_FETCH_SUCCESS",p="App/common/AdminNotifications/NOTIFICATIONS_FETCH_FAILURE",d="App/common/AdminNotifications/NOTIFICATIONS_SEEN_REQUEST",m="App/common/AdminNotifications/NOTIFICATIONS_SEEN_SUCCESS",N="App/common/AdminNotifications/NOTIFICATIONS_SEEN_FAILURE",b="App/common/AdminNotifications/NOTIFICATIONS_READ_UPDATE_REQUEST",g="App/common/AdminNotifications/NEW_NOTIFICATIONS_COUNT_REQUEST",O=n("371a6f90cf4b090759be"),A=Object(O.a)(u),_=Object(O.a)("App/common/AdminNotifications/NOTIFICATIONS_FETCH_UNREAD_SUCCESS","newNotifications"),I=Object(O.a)("App/common/AdminNotifications/NOTIFICATIONS_FETCH_UNREAD_FAILURE","error"),S=Object(O.a)(f,"page"),v=Object(O.a)(l,"allNotifications"),y=Object(O.a)(p,"error"),T=Object(O.a)(d),C=Object(O.a)(m,"response"),E=Object(O.a)(N,"error"),h=Object(O.a)(b,"notificationId"),w=Object(O.a)("App/common/AdminNotifications/NOTIFICATIONS_READ_UPDATE_SUCCESS","response"),j=Object(O.a)("App/common/AdminNotifications/NOTIFICATIONS_READ_UPDATE_FAILURE","error"),R=Object(O.a)(g),F=Object(O.a)("App/common/AdminNotifications/NEW_NOTIFICATIONS_COUNT_SUCCESS","newNotificationsCount"),U=Object(O.a)("App/common/AdminNotifications/NEW_NOTIFICATIONS_COUNT_FAILURE","error"),k=function(t){return t.get("adminNotifications")},x=function(){return Object(a.a)(k,(function(t){return t.get("notifications")}))},P=n("4f0dfcf9dfa819c812e6");function D(t,e,n,i){o||(o="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=t&&t.defaultProps,a=arguments.length-3;if(e||0===a||(e={children:void 0}),1===a)e.children=i;else if(a>1){for(var c=new Array(a),s=0;s<a;s++)c[s]=arguments[s+3];e.children=c}if(e&&r)for(var u in r)void 0===e[u]&&(e[u]=r[u]);else e||(e=r||{});return{$$typeof:o,type:t,key:void 0===n?null:""+n,ref:null,props:e,_owner:null}}var L=D("span",{}),q=D("span",{}),H=D("span",{}),J=D("span",{},void 0,D("i",{className:"icon-circle-o text-sm icon"})," Mark As Read"),M=function(t){var e=t._id,n=t.notification,o=t.added_on,i=t.updateNotificationReadStatus,r=t.seen,a=t.read,c=t.user,u=0,f=new Date,l=Object(P.a)(f).diff(Object(P.a)(o),"seconds");return l>59?(l=Object(P.a)(f).diff(Object(P.a)(o),"minutes"))>59?(l=Object(P.a)(f).diff(Object(P.a)(o),"hours"))>24?(l=Object(P.a)(f).diff(Object(P.a)(o),"days"),u="".concat(l).concat(l>1?" days":" day"," ago")):u="".concat(l).concat(l>1?" hours":" hour"," ago"):u="".concat(l).concat(l>1?" mins":" min"," ago"):u="".concat(l).concat(l>1?" seconds":" second"," ago"),D(s.a.Item,{className:"".concat(r?"seen":"not-seen")},void 0,D("div",{className:"notification_row clearfix"},void 0,c&&D("img",{className:"notification_row_img",src:c,alt:"user"}),D("div",{className:"notification_row_title"},void 0,n),D("div",{className:"text-sm text-muted notification_row_date"},void 0,u),D("span",{className:"button link right-btm has-icon mini",onClick:function(){return i(e)}},void 0,r?L:q,a?H:J)))};M.defaultProps={notification:"",user_id:"",added_by:"",seen:!1};var W=M;var Q=n("adc20f99e57c573c589c"),$=n("d95b0cf107403b178365"),z=n("54f683fcda7806277002"),B=n("62cade0222f879de1092"),G=Object(z.fromJS)({response:null,error:null,requesting:!1,success:!1,newNotificationsCount:0,notifications:{dataList:[],totalItems:0,currentPage:0},currentNotification:{}});var K=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case f:case d:case u:case g:return t.merge({requesting:!0,error:null,response:null,success:!1});case p:case N:case"App/common/AdminNotifications/NOTIFICATIONS_FETCH_UNREAD_FAILURE":case"App/common/AdminNotifications/NOTIFICATIONS_READ_UPDATE_FAILURE":case"App/common/AdminNotifications/NEW_NOTIFICATIONS_COUNT_FAILURE":return t.merge({requesting:!1,response:null,error:e.error.message,success:!1});case"App/common/AdminNotifications/NEW_NOTIFICATIONS_COUNT_SUCCESS":return t.merge({requesting:!1,response:null,error:null,success:!0,newNotificationsCount:e.newNotificationsCount.data.new_counts});case"App/common/AdminNotifications/NOTIFICATIONS_FETCH_UNREAD_SUCCESS":return t.merge({requesting:!1,response:null,error:null,success:!0,notifications:Object(z.fromJS)(e.newNotifications.data)});case l:return t.merge({requesting:!1,response:null,error:null,success:!0,notifications:Object(z.fromJS)(e.allNotifications.data)});case m:return t.merge({requesting:!1,response:null,error:null,success:!0,newNotificationsCount:0}).updateIn(["notifications","dataList"],(function(t){return t.map((function(t){return t.set("seen",!0)}))}));case b:return t.merge({requesting:!0,response:null,error:null,success:!0}).updateIn(["notifications","dataList"],(function(t){return t.map((function(t){return t.get("_id")===e.notificationId?t.set("read",!0):t}))}));case"App/common/AdminNotifications/NOTIFICATIONS_READ_UPDATE_SUCCESS":return t.merge({requesting:!1,response:null,error:null,success:!0}).updateIn(["notifications","dataList"],(function(t){return t.map((function(t){return t.get("_id")===e.response.data._id?t.set("read",!0):t}))}));case B.t:return G;default:return t}},V=n("6c68d13fe9e3e77d8fc4"),X=n("8636a5b0e6ac43ae8b4d"),Y=regeneratorRuntime.mark(it),Z=regeneratorRuntime.mark(rt),tt=regeneratorRuntime.mark(at),et=regeneratorRuntime.mark(ct),nt=regeneratorRuntime.mark(st),ot=regeneratorRuntime.mark(ut);function it(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("token"),e.next=3,Object(V.a)(X.a.get("notification/all?unread=true",_,I,t));case 3:case"end":return e.stop()}}),Y)}function rt(t){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=localStorage.getItem("token"),n.next=3,Object(V.a)(X.a.get("notification/all?page=".concat(t.page,"&perpage=10"),v,y,e));case 3:case"end":return n.stop()}}),Z)}function at(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("token"),e.next=3,Object(V.a)(X.a.get("notification/new",F,U,t));case 3:case"end":return e.stop()}}),tt)}function ct(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("token"),e.next=3,Object(V.c)(X.a.patch("notification/new",C,E,{},t));case 3:case"end":return e.stop()}}),et)}function st(t){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=localStorage.getItem("token"),n.next=3,Object(V.c)(X.a.patch("notification/status/update/".concat(t.notificationId),w,j,{},e));case 3:case"end":return n.stop()}}),nt)}function ut(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(V.g)(u,it);case 2:return t.next=4,Object(V.g)(f,rt);case 4:return t.next=6,Object(V.g)(g,at);case 6:return t.next=8,Object(V.g)(d,ct);case 8:return t.next=10,Object(V.g)(b,st);case 10:case"end":return t.stop()}}),ot)}var ft,lt=n("ab4cb61bcb2dc161defb");function pt(t){return(pt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dt(t,e,n,o){ft||(ft="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=t&&t.defaultProps,r=arguments.length-3;if(e||0===r||(e={children:void 0}),1===r)e.children=o;else if(r>1){for(var a=new Array(r),c=0;c<r;c++)a[c]=arguments[c+3];e.children=a}if(e&&i)for(var s in i)void 0===e[s]&&(e[s]=i[s]);else e||(e=i||{});return{$$typeof:ft,type:t,key:void 0===n?null:""+n,ref:null,props:e,_owner:null}}function mt(t){return function(t){if(Array.isArray(t))return Nt(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Nt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ot(t,e){return(Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function At(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=St(t);if(e){var i=St(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return _t(this,n)}}function _t(t,e){return!e||"object"!==pt(e)&&"function"!==typeof e?It(t):e}function It(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var yt=Object(a.b)({success:Object(a.a)(k,(function(t){return t.get("success")})),response:Object(a.a)(k,(function(t){return t.get("response")})),error:Object(a.a)(k,(function(t){return t.get("error")})),isRequesting:Object(a.a)(k,(function(t){return t.get("requesting")})),notifications:x(),currentNotification:Object(a.a)(k,(function(t){return t.get("currentNotification")})),newNotificationCount:Object(a.a)(k,(function(t){return t.get("newNotificationsCount")}))}),Tt=dt("i",{className:"icon-bell-o"}),Ct=dt("span",{className:"new_notifications_count"},void 0,"99",dt("i",{className:"fa fa-plus"})),Et=dt("i",{className:"icon-times-circle-o"}),ht=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ot(t,e)}(r,t);var e,n,o,i=At(r);function r(){var t;bt(this,r);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vt(It(t=i.call.apply(i,[this].concat(n))),"state",{loading:!0,totalItems:0,currentPage:1,notifications:[],isNotificationOpen:!1}),vt(It(t),"toggleNotification",(function(){t.props.newNotificationCount>0&&t.state.isNotificationOpen&&t.props.notificationsSeen(),t.setState({isNotificationOpen:!t.state.isNotificationOpen})})),vt(It(t),"updateNotificationReadStatus",(function(e){t.props.updateNotificationReadStatus(e)})),vt(It(t),"loadMore",(function(){t.setState({currentPage:t.state.currentPage+1},(function(){t.props.getAllNotifications(t.state.currentPage)}))})),t}return e=r,(n=[{key:"componentDidMount",value:function(){this.props.getNewNotificationStats(),this.props.getAllNotifications(1)}},{key:"componentWillReceiveProps",value:function(t){if(t.notifications!==this.props.notifications){var e=t.notifications;if(e.size>0){var n=e.toJS();this.setState({notifications:mt(n.dataList),totalItems:n.totalItems,currentPage:n.currentPage})}}}},{key:"render",value:function(){var t=this,e=this.state,n=e.totalItems,o=e.isNotificationOpen,i=e.notifications,r=this.props.newNotificationCount;return dt(s.a,{className:"nav-link",trigger:dt("span",{className:"notification",onClick:this.toggleNotification},void 0,Tt,r>0&&(r<=99?dt("span",{className:"new_notifications_count"},void 0,r):Ct)),id:"notification_dropdown",open:o},void 0,dt(s.a.Menu,{},void 0,dt("div",{className:"flex"},void 0,dt("div",{className:"emptyArea",onClick:this.toggleNotification}),dt("div",{className:"content"},void 0,dt("div",{className:"pd-all-sm"},void 0,dt("h5",{className:"thin clearfix"},void 0,"NOTIFICATIONS",dt("span",{className:"float-right pointer",onClick:this.toggleNotification},void 0,Et))),i.map((function(e,n){return dt(W,{_id:e._id,notification:e.notification,user_id:e.user_id,added_by:e.added_by,added_on:e.added_on,updateNotificationReadStatus:t.updateNotificationReadStatus,seen:e.seen,read:e.read},n)})),i.length!==n&&i.length>10&&dt("div",{onClick:this.loadMore},void 0,"show more")))))}}])&&gt(e.prototype,n),o&&gt(e,o),r}(r.a.Component),wt=Object($.a)({key:"adminNotifications",reducer:K}),jt=Object(Q.a)({key:"adminNotifications",saga:ut}),Rt=Object(c.connect)(yt,(function(t){return{getNewNotificationStats:function(){return t(R())},notificationsSeen:function(){return t(T())},getUnReadNotifications:function(){return t(A())},getAllNotifications:function(e){return t(S(e))},updateNotificationReadStatus:function(e){return t(h(e))}}}));e.default=Object(lt.compose)(wt,jt,Rt)(ht)}}]);